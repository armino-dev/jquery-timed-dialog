(()=>{(function(t){t.fn.timedDialog=function(f){this.defaults={type:"info",title:"Info",body:"This is the default body text. You might replace this with your own.",width:320,height:240,appendTo:"body",closeOnEscape:!0,closeOnTimer:!1,timeout:10,timeoutAnimation:!0,isModal:!0,btnDismiss:{text:"Dismiss",class:""},btnConfirm:{text:"Confirm",action:()=>{},class:""}};let e=t.extend({},this.defaults,f),{documentHeight:C,documentWidth:T}=w(),D={info:{icon:{src:"i"},style:"info"},confirmation:{icon:{src:"?"},style:"info"}},m=0;e.icon=D[e.type].icon.src;let W={position:"absolute",top:0,left:0,width:T+"px",height:C+"px","z-index":"2000"},k={position:"absolute",width:e.width+"px",height:e.height+"px","line-height":"20px","z-index":"2001"},r=A(5),p="timed-dialog-"+r,c=t(`<div id="overlay-${p}" class="timed-dialog-overlay"></div>`),o=t(`
                    <div id="${p}" class="timed-dialog">
                        <div class="header">
                            <div class="icon"><span>${e.icon}</span></div>
                            <h1 class="title">${e.title}</h1>
                        </div>
                        <div class="body">${e.body}</div>
                        <div class="action"> </div>
                    </div>
            `),s=t(`<button 
            class="btn btn-primary" 
            style="position:relative;" 
            id="btn-dismiss-${r}">
                <span class="text">${e.btnDismiss.text}</span>
            </button>
        `),g=t(`<button 
            class="btn btn-primary" 
            id="btn-confirm-${r}">
                ${e.btnConfirm.text}
            </button>
        `),b=t(`<button id="btn-close-${r}" class="btn btn-close">x</button>`);if(this.length>1)return this.each(function(){t(this).timedDialog(f)}),this;function w(){let i=document.body,n=document.documentElement,a=[i.scrollHeight,i.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight],d=[i.scrollWidth,i.offsetWidth,n.clientWidth,n.scrollWidth,n.offsetWidth],h=Math.max(...a),u=Math.max(...d);return{documentHeight:h,documentWidth:u}}function A(i){let n="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let d=0;d<i;d++)n+=a.charAt(Math.floor(Math.random()*a.length));return n}function l(){m&&window.cancelAnimationFrame(m),t(o).fadeOut(),t(c).fadeOut(500,()=>{t(c).remove()})}t(window).on("resize",()=>{y()}),t(document).on("scroll",()=>{y()});function H(i){let n=t(s).children("span.text").html();t(s).children("span.text").html(n+` (${i})`);let a=setInterval(()=>{i--,t(s).children("span.text").html(n+` (${i})`),i<1&&(clearInterval(a),t(s).trigger("click"))},1e3)}function O(){t(s).on("click",()=>{l()}),t(s).on("mouseenter",()=>{t("span.meter").addClass("hover")}),t(s).on("mouseleave",()=>{t("span.meter").removeClass("hover")}),t(b).on("click",()=>{l()}),t(g).on("click",()=>{if(typeof e.btnConfirm.action=="function"){try{e.btnConfirm.action()}catch(i){console.error(i)}l()}else throw new Error("Confirmation button action must be a callback")}),t(c).on("click",i=>{o.not(i.target)&&o.has(i.target).length===0&&l()}),t(document).on("keydown",i=>{e.closeOnEscape&&i.key==="Escape"&&l()})}function z(){let i=t(s).width(),n=t('<span class="meter"></span>');t(n).appendTo(s);let a=1e3*e.timeout,d=i,h,u=v=>{h===void 0&&(h=v);let x=v-h;t(n).width(d),d=i*(1-x/a),x<a&&(m=window.requestAnimationFrame(u))};m=window.requestAnimationFrame(u)}function y(){let{documentHeight:i,documentWidth:n}=w();t(c).css({width:n+"px",height:i+"px"}),t(o).css({left:t(document).scrollLeft()+(t(window).width()-e.width)/2+"px",top:t(document).scrollTop()+(t(window).height()-e.height)/2+"px"})}return this.random=r,this.overlay=c,this.dialog=o,this.dismissDialog=l,this.initialize=()=>{if(!t(".timed-dialog-overlay").length)return t("body").append(c),e.isModal&&c.css(W),t(o).appendTo(c),t(o).css(k),t(window).trigger("resize"),t(b).appendTo(o.children("div.header")),t(s).appendTo(o.children(".action")),e.type=="confirmation"&&t(g).appendTo(o.children(".action")),O(),t(o).hide().fadeIn(300,()=>{e.closeOnTimer&&(H(e.timeout),e.timeoutAnimation&&z())}),this},this.initialize()}})(jQuery);})();
