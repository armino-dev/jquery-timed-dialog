(()=>{(function(t){t.fn.timedDialog=function(p){this.defaults={type:"info",title:"Info",body:"This is the default body text. You might replace this with your own.",width:320,height:240,appendTo:"body",closeOnEscape:!0,closeOnTimer:!1,timeout:10,timeoutAnimation:!0,isModal:!0,btnDismiss:{text:"Dismiss",class:""},btnConfirm:{text:"Confirm",action:()=>{},class:""}};let i=t.extend({},this.defaults,p),m=document.body,d=document.documentElement,A=[m.scrollHeight,m.offsetHeight,d.clientHeight,d.scrollHeight,d.offsetHeight],O=[m.scrollWidth,m.offsetWidth,d.clientWidth,d.scrollWidth,d.offsetWidth],b=Math.max(...A),g=Math.max(...O),W={info:{icon:{src:"i"},style:"info"},confirmation:{icon:{src:"?"},style:"info"}},f=0;i.icon=W[i.type].icon.src;let k={position:"absolute",top:0,left:0,width:g+"px",height:b+"px","z-index":"2000"},z={position:"absolute",width:i.width+"px",height:i.height+"px","line-height":"20px","z-index":"2001"},c=H(5),w="timed-dialog-"+c,s=t(`<div id="overlay-${w}" class="timed-dialog-overlay"></div>`),n=t(`
                    <div id="${w}" class="timed-dialog">
                        <div class="header">
                            <div class="icon"><span>${i.icon}</span></div>
                            <h1 class="title">${i.title}</h1>
                        </div>
                        <div class="body">${i.body}</div>
                        <div class="action"> </div>
                    </div>
            `),o=t(`<button 
            class="btn btn-primary" 
            style="position:relative;" 
            id="btn-dismiss-${c}">
                <span class="text">${i.btnDismiss.text}</span>
            </button>
        `),y=t(`<button 
            class="btn btn-primary" 
            id="btn-confirm-${c}">
                ${i.btnConfirm.text}
            </button>
        `),v=t(`<button id="btn-close-${c}" class="btn btn-close">x</button>`);if(this.length>1)return this.each(function(){t(this).timedDialog(p)}),this;function H(e){let a="",l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let h=0;h<e;h++)a+=l.charAt(Math.floor(Math.random()*l.length));return a}function r(){f&&window.cancelAnimationFrame(f),t(n).fadeOut(),t(s).fadeOut(500,()=>{t(s).remove()})}t(window).on("resize",()=>{x()}),t(document).on("scroll",()=>{x()});function I(e){let a=t(o).children("span.text").html();t(o).children("span.text").html(a+` (${e})`);let l=setInterval(()=>{e--,t(o).children("span.text").html(a+` (${e})`),e<1&&(clearInterval(l),t(o).trigger("click"))},1e3)}function M(){t(o).on("click",()=>{r()}),t(o).on("mouseenter",()=>{t("span.meter").addClass("hover")}),t(o).on("mouseleave",()=>{t("span.meter").removeClass("hover")}),t(v).on("click",()=>{r()}),t(y).on("click",()=>{if(typeof i.btnConfirm.action=="function"){try{i.btnConfirm.action()}catch(e){console.error(e)}r()}else throw new Error("Confirmation button action must be a callback")}),t(s).on("click",e=>{n.not(e.target)&&n.has(e.target).length===0&&r()})}function E(){let e=t(o).width(),a=t('<span class="meter"></span>');t(a).appendTo(o);let l=1e3*i.timeout,h=e,u,C=T=>{u===void 0&&(u=T);let D=T-u;t(a).width(h),h=e*(1-D/l),D<l&&(f=window.requestAnimationFrame(C))};f=window.requestAnimationFrame(C)}function x(){t(s).css({width:g+"px",height:b+"px"}),t(n).css({left:t(document).scrollLeft()+(t(window).width()-i.width)/2+"px",top:t(document).scrollTop()+(t(window).height()-i.height)/2+"px"})}return this.random=c,this.overlay=s,this.dialog=n,this.dismissDialog=r,this.initialize=()=>{if(!t(".timed-dialog-overlay").length)return t("body").append(s),i.isModal&&s.css(k),t(n).appendTo(s),t(n).css(z),t(window).trigger("resize"),t(v).appendTo(n.children("div.header")),t(o).appendTo(n.children(".action")),i.type=="confirmation"&&t(y).appendTo(n.children(".action")),M(),t(n).hide().fadeIn(300,()=>{i.closeOnTimer&&(I(i.timeout),i.timeoutAnimation&&E())}),this},this.initialize()}})(jQuery);})();
