(()=>{var t;(t=jQuery).fn.timedDialog=function(i){this.defaults={type:"info",title:"Info",body:"This is the default body text. You might replace this with your own.",width:320,height:240,appendTo:"body",closeOnEscape:!0,closeOnTimer:!1,timeout:10,timeoutAnimation:!0,isModal:!0,btnDismiss:{text:"Dismiss",class:""},btnConfirm:{text:"Confirm",action:()=>{},class:""}};let n=t.extend({},this.defaults,i);const e=document.body,o=document.documentElement,s=[e.scrollHeight,e.offsetHeight,o.clientHeight,o.scrollHeight,o.offsetHeight],a=[e.scrollWidth,e.offsetWidth,o.clientWidth,o.scrollWidth,o.offsetWidth],l=Math.max(s),c=Math.max(a);let d=0;n.icon={info:{icon:{src:"i"},style:"info"},confirmation:{icon:{src:"?"},style:"info"}}[n.type].icon.src;const r={position:"absolute",top:0,left:0,width:c+"px",height:l+"px","z-index":"2000"},h={position:"absolute",width:n.width+"px",height:n.height+"px","line-height":"20px","z-index":"2001"},m=function(t){let i="";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let t=0;t<5;t++)i+=n.charAt(Math.floor(Math.random()*n.length));return i}(),p="timed-dialog-"+m,f=t(`<div id="overlay-${p}" class="timed-dialog-overlay"></div>`),u=t(`\n                    <div id="${p}" class="timed-dialog">\n                        <div class="header">\n                            <div class="icon"><span>${n.icon}</span></div>\n                            <h1 class="title">${n.title}</h1>\n                        </div>\n                        <div class="body">${n.body}</div>\n                        <div class="action"> </div>\n                    </div>\n            `),b=t(`<button \n            class="btn btn-primary" \n            style="position:relative;" \n            id="btn-dismiss-${m}">\n                <span class="text">${n.btnDismiss.text}</span>\n            </button>\n        `),g=t(`<button \n            class="btn btn-primary" \n            id="btn-confirm-${m}">\n                ${n.btnConfirm.text}\n            </button>\n        `),w=t(`<button id="btn-close-${m}" class="btn btn-close">x</button>`);if(this.length>1)return this.each((function(){t(this).timedDialog(i)})),this;function v(){d&&window.cancelAnimationFrame(d),t(u).fadeOut(),t(f).fadeOut(500,(()=>{t(f).remove()}))}function x(){t(f).css({width:c+"px",height:l+"px"}),t(u).css({left:t(document).scrollLeft()+(t(window).width()-n.width)/2+"px",top:t(document).scrollTop()+(t(window).height()-n.height)/2+"px"})}return t(window).on("resize",(()=>{x()})),t(document).on("scroll",(()=>{x()})),this.random=m,this.initialize=()=>{if(!t(".timed-dialog-overlay").length)return t("body").append(f),n.isModal&&f.css(r),t(u).appendTo(f),t(u).css(h),t(window).trigger("resize"),t(w).appendTo(u.children("div.header")),t(b).appendTo(u.children(".action")),"confirmation"==n.type&&t(g).appendTo(u.children(".action")),t(b).on("click",(()=>{v()})),t(b).on("mouseenter",(()=>{t("span.meter").addClass("hover")})),t(b).on("mouseleave",(()=>{t("span.meter").removeClass("hover")})),t(w).on("click",(()=>{v()})),t(g).on("click",(()=>{if("function"!=typeof n.btnConfirm.action)throw new Error("Confirmation button action must be a callback");try{n.btnConfirm.action()}catch(t){console.error(t)}v()})),t(f).on("click",(t=>{u.not(t.target)&&0===u.has(t.target).length&&v()})),t(u).hide().fadeIn(300,(()=>{n.closeOnTimer&&(function(i){let n=t(b).children("span.text").html();t(b).children("span.text").html(n+` (${i})`);let e=setInterval((()=>{i--,t(b).children("span.text").html(n+` (${i})`),i<1&&(clearInterval(e),t(b).trigger("click"))}),1e3)}(n.timeout),n.timeoutAnimation&&function(){const i=t(b).width(),e=t('<span class="meter"></span>');t(e).appendTo(b);const o=1e3*n.timeout;let s,a=i;const l=n=>{void 0===s&&(s=n);const c=n-s;t(e).width(a),a=i*(1-c/o),c<o&&(d=window.requestAnimationFrame(l))};d=window.requestAnimationFrame(l)}())})),this},this.initialize()}})();